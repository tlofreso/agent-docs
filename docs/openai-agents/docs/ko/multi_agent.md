---
search:
  exclude: true
---
# 멀티 에이전트 오케스트레이션

오케스트레이션은 앱에서 에이전트가 흐르는 방식을 의미합니다. 어떤 에이전트를 어떤 순서로 실행하고, 다음에 무엇을 할지 어떻게 결정할까요? 에이전트를 오케스트레이션하는 주요 방법은 두 가지입니다:

1. LLM 에게 결정을 맡기기: LLM 의 지능을 활용해 계획하고 추론하며 그에 따른 다음 단계를 결정하는 방식
2. 코드로 오케스트레이션하기: 코드로 에이전트의 흐름을 결정하는 방식

이 패턴은 혼합해서 사용할 수 있습니다. 각각의 트레이드오프는 아래에 설명되어 있습니다.

## LLM 기반 오케스트레이션

에이전트는 instructions, tools, 핸드오프로 무장한 LLM 입니다. 즉, 개방형 과제가 주어지면 LLM 이 도구를 사용해 행동하고 데이터를 수집하며, 핸드오프를 통해 하위 에이전트에 작업을 위임하면서 과제를 해결하는 계획을 자율적으로 수립할 수 있습니다. 예를 들어, 리서치 에이전트는 다음과 같은 도구를 갖출 수 있습니다:

- Web search 를 통한 온라인 정보 찾기
- File search 및 검색을 통한 사내 데이터와 연결 탐색
- 컴퓨터 사용 을 통한 컴퓨터 상의 액션 수행
- 코드 실행을 통한 데이터 분석
- 기획, 보고서 작성 등 특정 분야에 특화된 에이전트로의 핸드오프

이 패턴은 과제가 개방형이고 LLM 의 지능에 의존하고자 할 때 좋습니다. 여기서 가장 중요한 전술은 다음과 같습니다:

1. 좋은 프롬프트에 투자하세요. 사용 가능한 도구, 사용 방법, 작동해야 하는 매개변수를 명확히 하세요.
2. 앱을 모니터링하고 반복 개선하세요. 어디서 문제가 생기는지 파악하고 프롬프트를 개선하세요.
3. 에이전트가 자기 성찰하고 개선할 수 있게 하세요. 예를 들어 루프로 실행해 스스로를 비판하게 하거나, 오류 메시지를 제공해 개선하도록 하세요.
4. 모든 것을 잘하는 범용 에이전트보다는 하나의 작업에 뛰어난 특화 에이전트를 두세요.
5. [평가(evals)](https://platform.openai.com/docs/guides/evals)에 투자하세요. 이를 통해 에이전트를 학습시켜 성능을 향상할 수 있습니다.

## 코드 기반 오케스트레이션

LLM 기반 오케스트레이션이 강력하긴 하지만, 코드 기반 오케스트레이션은 속도, 비용, 성능 측면에서 작업을 더 결정적이고 예측 가능하게 만듭니다. 일반적인 패턴은 다음과 같습니다:

- [structured outputs](https://platform.openai.com/docs/guides/structured-outputs)를 사용해 코드로 검사할 수 있는 적절한 형식의 데이터 를 생성하기. 예를 들어, 에이전트에게 작업을 몇 가지 카테고리 로 분류하게 한 뒤, 카테고리 에 따라 다음 에이전트를 선택할 수 있습니다.
- 한 에이전트의 출력을 다음 에이전트의 입력으로 변환하여 여러 에이전트를 체이닝하기. 블로그 글 작성 같은 작업을 리서치, 개요 작성, 본문 작성, 비판, 개선의 일련의 단계로 분해할 수 있습니다.
- 평가 및 피드백을 제공하는 에이전트와 작업을 수행하는 에이전트를 `while` 루프로 함께 실행하고, 평가자가 출력이 특정 기준을 통과했다고 말할 때까지 반복하기
- `asyncio.gather` 같은 파이썬 기본 컴포넌트 를 통해 여러 에이전트를 병렬 실행하기. 서로 의존하지 않는 여러 작업이 있을 때 속도 향상에 유용합니다.

[`examples/agent_patterns`](https://github.com/openai/openai-agents-python/tree/main/examples/agent_patterns)에 다수의 코드 예제가 있습니다.